using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Reflection;
using BeatSaberPlaylistsLib;
using BeatSaberPlaylistsLib.Blist;
using BeatSaberPlaylistsLib.Legacy;
using UnityEngine;

namespace PlaylistManager.Utilities
{
    public class PlaylistLibUtils
    {
        public const string DEFAULT_IMAGE = "data:image/jpeg;base64,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";

        public static BeatSaberPlaylistsLib.PlaylistManager playlistManager
        {
            get
            {
                return BeatSaberPlaylistsLib.PlaylistManager.DefaultManager;
            }
        }

        public static void CreatePlaylist(string playlistName, string playlistAuthorName)
        {
            CreatePlaylist(playlistName, playlistAuthorName, DEFAULT_IMAGE);
        }

        public static void CreatePlaylist(string playlistName, string playlistAuthorName, string image)
        {
            string playlistFolderPath = Path.Combine(Environment.CurrentDirectory, "Playlists");
            string playlistFileName = string.Join("_", playlistName.Replace("/", "").Replace("\\", "").Split(' '));
            if (string.IsNullOrEmpty(playlistFileName))
            {
                playlistFileName = "playlist";
            }
            string playlistPath = Path.Combine(playlistFolderPath, playlistFileName + ".blist");
            string originalPlaylistPath = Path.Combine(playlistFolderPath, playlistFileName);
            int dupNum = 0;
            while (File.Exists(playlistPath))
            {
                dupNum++;
                playlistPath = originalPlaylistPath + string.Format("({0}).blist", dupNum);
                playlistFileName = playlistFileName + string.Format("({0})", dupNum);
            }
            BeatSaberPlaylistsLib.Types.IPlaylist playlist = playlistManager.CreatePlaylist(playlistFileName, playlistName, playlistAuthorName, image);
            playlist.AllowDuplicates = true;
            playlistManager.StorePlaylist(playlist);
        }

        #region Image

        private static DrawSettings defaultDrawSettings = new DrawSettings
        {
            Color = System.Drawing.Color.Black,
            DrawStyle = DrawStyle.Normal,
            Font = new Font("arial", 60, FontStyle.Regular),
            StringFormat = new StringFormat()
            {
                Alignment = StringAlignment.Center,
                LineAlignment = StringAlignment.Center
            },
            MinTextSize = 30,
            MaxTextSize = 60,
            WrapWidth = 10
        };

        private static Stream GetFolderImageStream() =>
            Assembly.GetExecutingAssembly().GetManifestResourceStream("PlaylistManager.Icons.FolderIcon.png");

        internal static Sprite DrawFolderIcon(string str)
        {
            Image img = ImageUtilities.DrawString(str, Image.FromStream(GetFolderImageStream()), defaultDrawSettings);
            MemoryStream ms = new MemoryStream();
            img.Save(ms, ImageFormat.Png);
            return BeatSaberMarkupLanguage.Utilities.LoadSpriteRaw(ms.ToArray());
        }

        #endregion
    }
}
